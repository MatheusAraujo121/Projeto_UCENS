<main class="cadastro-page">
  <div class="cadastro-container">
    <img src="assets/carp.jpg" class="bg-carpa" alt="carpa" />
    <h2>Editar Evento #{{ eventId }}</h2>

    <form [formGroup]="form" (ngSubmit)="efetuarAtualizacao()">
      <p class="section-label"><em>Imagem do Evento</em></p>
      <div class="form-grid full-width preview-container">
        <div>
          <img *ngIf="previewUrl" [src]="previewUrl" class="image-preview" alt="Prévia do evento" />
        </div>
      </div>

      <div class="form-grid full-width">
        <button mat-stroked-button type="button" class="upload-btn" (click)="fileInput.click()">
          <mat-icon>upload</mat-icon>
          Selecionar Nova Imagem
        </button>
        <input #fileInput type="file" accept="image/*" (change)="onFileChange($event)" hidden />
      </div>

      <p class="section-label"><em>Informações do Evento</em></p>
      <div class="form-grid">
        <mat-form-field appearance="fill">
          <mat-label>Nome do Evento</mat-label>
          <input matInput formControlName="nome" />
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Local</mat-label>
          <input type="text" matInput formControlName="local" [matAutocomplete]="auto">
          <mat-autocomplete #auto="matAutocomplete">
            <mat-option *ngFor="let option of filteredOptions | async" [value]="option">
              {{option}}
            </mat-option>
          </mat-autocomplete>
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Data de Início</mat-label>
          <input matInput formControlName="dataInicio" type="date" />
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Data de Término</mat-label>
          <input matInput formControlName="dataFinal" type="date" />
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Horário de Início</mat-label>
          <input matInput formControlName="horarioInicio" type="time" />
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Horário de Término</mat-label>
          <input matInput formControlName="horarioFinal" type="time" />
        </mat-form-field>

        <mat-form-field appearance="fill" class="full-width">
          <mat-label>Descrição</mat-label>
          <textarea matInput formControlName="descricao"></textarea>
        </mat-form-field>
      </div>

      <div class="btns-bottom">
        <button mat-stroked-button class="btn-cancel" routerLink="/list-events">
          <mat-icon>close</mat-icon>
          <span>Cancelar</span>
        </button>
        <button mat-stroked-button class="btn-submit" type="submit" [disabled]="form.invalid || isLoading">
          <mat-icon>save</mat-icon>
          <span *ngIf="!isLoading">Salvar Alterações</span>
          <span *ngIf="isLoading">Salvando...</span>
        </button>
      </div>
    </form>
  </div>
</main>