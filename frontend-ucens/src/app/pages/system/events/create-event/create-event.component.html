<main class="cadastro-page">
  <div class="cadastro-container">
    <img src="assets/carp.jpg" class="bg-carpa" alt="carpa" />
    <h2>Cadastrar Novo Evento</h2>

    <form [formGroup]="form" (ngSubmit)="efetuarCadastro()">
      <p class="section-label"><em>Imagem do Evento</em></p>
      <div class="form-grid full-width preview-container">
        <div>
          <img *ngIf="previewUrl" [src]="previewUrl" class="image-preview" alt="Prévia do evento" />
        </div>
      </div>

      <div class="form-grid full-width">
        <button mat-stroked-button type="button" class="upload-btn" (click)="fileInput.click()">
          <mat-icon>upload</mat-icon>
          Selecionar Imagem
        </button>
        <input #fileInput type="file" accept="image/*" (change)="onFileChange($event)" hidden />
      </div>

      <p class="section-label"><em>Informações do Evento</em></p>
      <div class="form-grid">
        <mat-form-field appearance="fill">
          <mat-label>Nome do Evento</mat-label>
          <input matInput formControlName="nome" placeholder="Ex: Ano novo" />
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Local</mat-label>
          <input type="text" placeholder="Digite ou selecione um local" matInput formControlName="local"
            [matAutocomplete]="auto">
          <mat-autocomplete #auto="matAutocomplete">
            <mat-option *ngFor="let option of filteredOptions | async" [value]="option">
              {{option}}
            </mat-option>
          </mat-autocomplete>
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Data de Início</mat-label>
          <input matInput [matDatepicker]="pickerInicio" formControlName="dataInicio">
          <mat-datepicker-toggle matSuffix [for]="pickerInicio"></mat-datepicker-toggle>
          <mat-datepicker #pickerInicio></mat-datepicker>
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Data de Término</mat-label>
          <input matInput [matDatepicker]="pickerFinal" formControlName="dataFinal">
          <mat-datepicker-toggle matSuffix [for]="pickerFinal"></mat-datepicker-toggle>
          <mat-datepicker #pickerFinal></mat-datepicker>
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Horário de Início</mat-label>
          <input matInput formControlName="horarioInicio" type="time" />
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Horário de Término</mat-label>
          <input matInput formControlName="horarioFinal" type="time" />
        </mat-form-field>

        <mat-form-field appearance="fill" class="full-width">
          <mat-label>Descrição</mat-label>
          <textarea matInput formControlName="descricao" placeholder="Descreva brevemente o evento..."></textarea>
        </mat-form-field>
      </div>

      <div class="btns-bottom">
        <button mat-stroked-button class="btn-cancel" routerLink="/list-events">
          <mat-icon>close</mat-icon>
          <span>Cancelar</span>
        </button>
        <button mat-stroked-button class="btn-submit" type="submit" [disabled]="form.invalid || isLoading">
          <mat-icon>radio_button_unchecked</mat-icon>
          <span *ngIf="!isLoading">Cadastrar Evento</span>
          <span *ngIf="isLoading">Cadastrando...</span>
        </button>
      </div>
    </form>
  </div>
</main>